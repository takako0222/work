<!DOCTYPE html>
<html lang="jp">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>Modal Test</title>
    <meta charset="utf-8" />
    <meta name="description" content="" />
    <meta name="author" content="" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="./style.css" />
    <link rel="shortcut icon" href="" />
  </head>
  <body>
    <div class="content">
      <p class="modal_btn_pc">
        <a class="js-modal-open" href="">クリックでモーダルを表示</a
        ><span class="close">X</span>
      </p>
      <p class="modal_btn_sp">
        <a class="js-modal-open2" href="">SP用</a><span class="close">X</span class="close">
      </p>
    </div>
    <div class="modal js-modal">
      <div class="modal__bg js-modal-close"></div>
      <div class="modal__content">
        <p>
          ここにモーダルウィンドウで表示したいコンテンツを入れます。モーダルウィンドウを閉じる場合は下の「閉じる」をクリックするか、背景の黒い部分をクリックしても閉じることができます。
        </p>
        <a class="js-modal-close" href="">閉じる</a>
      </div>
      <!--modal__inner-->
    </div>

    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>
    <p>スクロールテスト</p>

    <!--modal-->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.2/jquery.min.js"></script>
    <script>
      //modal
      $(function() {
        $(".js-modal-open").on("click", function() {
          $(".js-modal").fadeIn();
          return false;
        });
        $(".js-modal-close").on("click", function() {
          $(".js-modal").fadeOut();
          return false;
        });
      });
      $(function() {
        $(".js-modal-open2").on("click", function() {
          $(".js-modal").fadeIn();
          return false;
        });
        $(".js-modal-close").on("click", function() {
          $(".js-modal").fadeOut();
          return false;
        });
      });

      $(function () {
        $(".modal_btn_pc .close").on("click", function () {
          $(".modal_btn_pc").fadeOut();
          return false;
        });
      });
      $(function () {
        $(".modal_btn_sp .close").on("click", function () {
          $(".modal_btn_sp").fadeOut();
          return false;
        });
      });

      //スクロールしたら表示
      function campaign_window() {
        if ($(this).scrollTop() > 300) {
          //フェードインで表示
          $(".modal_btn_pc").fadeIn();
          // 上から降ってくる処理
          $(".modal_btn_pc").addClass("appear");
          $(".modal_btn_pc").show();
        } else {
          $(".modal_btn_pc").removeClass("appear");
        }
      }
      $(function() {
        //スクロールに応じてスクロールを出す処理をスクロールイベントにバインドする。
        $(window).on("scroll", campaign_window);
      });

      //スクロール中非表示
      $(function() {
        $(window).on("scroll touchmove", function() {
          scrollHeight = $(document).height();
          scrollPosition = $(window).height() + $(window).scrollTop();
          if (scrollHeight - scrollPosition < 300) {
            //スクロールの位置が下部5%の範囲に来た場合
            $(".modal_btn_sp").css("display", "none");
          } else {
            //それ以外のスクロールの位置の場合
            $(".modal_btn_sp").css("display", "block");
            //スクロール中に判断する
            $(".modal_btn_sp").stop(); //アニメーションしている場合、アニメーションを強制停止
            $(".modal_btn_sp")
              .css("display", "none")
              .delay(100)
              .fadeIn("fast"); //スクロール中は非表示にして、500ミリ秒遅らせて再び表示
          }
        });
      });
    </script>
  </body>
</html>
